---
title: "게임수학&물리 004_시간"
date: 2019-03-06 12:00:00 -0400
categories: "게임수학&물리"
comments: true
---





## 프레임

**프레임 레이트(frame rate)**는 디스플레이 장치가 화면 하나의 데이터를 표시하는 속도, **프레임(frame)** 이라고도 부른다.

보통 눈의 잔상을 이용해서 표시하기 때문에 1초에 30번 또는 25번 이상이 필요하나, 부드러운 표시를 위해서 1초에 60~120번의 프레임을 표시하기도 한다.



#### fps

frames per second, 즉 **초당 프레임 수**를 나타내며, 1초 동안 보여주는 화면의 수를 가리킨다.

프레임 사이 시간 간격이 길면 움직임은 부드럽지 못하고 끊기게 된다. 예를들어 1/30초로 프레임 구성을 하면 1/60초와 비교해서 그림 개수가 반으로 줄어든다.

하지만 시간을 길게 하면 프레임 하나를 그리는데 사용할 수 있는 시간이 2배가 된다. 이를 이용해서 복잡한 처리를 할 수 있다.

게임에 따라서 알맞는 프레임을 사용하는 것이 좋다.



#### 프레임 드롭

프레임은 디스플레이 동기화를 사용해 처리하므로 매우 짧은 시간 안에 끝났더라도 동기화 시간까지 대기하는 것이 일반적이다.

반대로 프레임 처리가 생각보다 늦어져 프레임 시간 안에 끝나지 않았을 때에는 다음 동기화 타이밍까지 기다리게 된다.

이렇게 원래 처리 시간에 처리가 끝나지 않아 다음 동기화 타이밍을 기다리는 것을 **프레임 드롭**이라고 한다.

예를들어 프레임마다 (5, 0)씩 움직이는 플레이어가 있다고 한다면 프레임 드롭이 생기면 (5, 0)만큼의 이동이 덜 되는 것이다.

이러한 현상을 대처하기위한 여러가지 방법들이 있다.

- 기본 fps를 다시 설정
- 프레임 스킵
- 앞 프레임과 시간 차이 계산
- 프레임 드롭을 해결하지 않는다.

##### 기본 fps를 다시 설정

60fps로 만들고 있는 게임에서 프레임 드롭이 자주 발생한다면 프레임을 처리시간이 긴 30fps를 선택해서 프레임 드롭을 피할 수 있다.

하지만 개발 초기에 60fps로 만들다가 개발 중기나 말기에 30fps로 전환하는 식의 설계 변경은 가급적 피해야한다. 속도나 시간 관리 등 모든 곳에서 60fps를 가정하고 만든 프로그램을 30fps로 다시 만들어야 하기 때문이다.

| fps   | 장점                                                         | 단점                                                |
| ----- | ------------------------------------------------------------ | --------------------------------------------------- |
| 60fps | 움직임이 부드럽다.                                           | 처리 시간이 짧아 프레임 드롭이 발생할 가능성이 높다 |
| 30fps | 처리 시간이 길어 프레임 드롭이 발생할 가능성이 낮다.<br />시간이 걸리는 처리도 할 수 있다. | 움직임이 거칠다.                                    |

이러한 특징을 토대로 세밀한 움직임을 중시하는 격투 게임은 60fps로 화려한 장면이 많은 액션 게임은 30fps로 설정하는 등 개발 초기에 게임의 특성에 따라 fps를 미리 결정해 놓는 것이 좋다.

##### 프레임 스킵

게임의 한 장면에서 게임에 관련된 계산 처리 부분과 그 결과를 바탕으로 그림을 그리는 부분을 역할을 따로 나누어 둔다.

이런 상태에서 앞 그림 그리기 처리에서 프레임 드롭이 발생하면 동기화를 기다리지 않고 바로 계산 처리만 다시 수행하고 다음 동기화를 기다리는 것을 프레임 스킵이라고 한다.

프레임 스킵이면 평소에는 60fps로 가동하고, 프레임 드롭이 발생했을 때는 그림 그리기 처리에서 만든 그림을 30fps로 갱신하면서 게임 내부의 움직임을 60fps로 유지할 수 있어서 사용자에게 동작이 느려졌다는 느낌을 주지 않을 수 있다.

단, 프레임 스킵 방법은 프로그램 작성이 까다롭고, 각 처리 부분을 분명하게 나눠놓아야 한다.

##### 앞 프레임과 시간 차이를 계산

이번에 설명할 프레임 드롭 대책은 두 프레임 사이의 시간을 사용하는 방법이다.

각 프레임에서 처리를 수행하는 도중에 앞 프레임에서 지금 프레임의 시간까지 걸린 처리 시간을 얻을 수 있도록 한다.

60fps의 게임을 만든다고 가정했을 때, 일반적인 상황에서는 두 처리 시작 시간 차이가 1/60초 일것이다. 만약 프레임 드롭이 발생한다면 두 처리 시작 시간 차이는 1/30초가 될 것이다.

만약에 앞 프레임에서 프레임 드롭이 발생했다면, 플레이어 이동 등 프레임별로 계산되는 연산들을 프레임 드롭 된 만큼 연산을 더 해주면 사용자 입장에서는 동작이 느리게 느껴지지 않을 것이다.

단, 이 방법은 시간을 고려차는 처리 부분이 필요하고, 정밀도가 낮은 프레임 레이트로 변할 때가 있어서 의도된 게임 처리 처럼 제대로 계산이 안 될수도 있다.

##### 프레임 드롭을 해결하지 않는다.

대책이라고 할 수는 없지만, 프레임 드롭을 해결하지 않는 방법도 있다.

프레임 드롭이 발생했을 때 속도가 느려지지만 작업 비용이 0이므로 가장 쉬운 방법이라고 할 수 있다.

예를 들어, 1프레임 단위가 중요한 격투게임 같은 경우에는 위에 방법들을 사용하면 움직임이 눈에 띄게 느려지지는 않지만, 표시되는 화면은 한 장면이 빠지게 되기 때문에 게임의 질이 떨어질 수 있다. 따라서 격투게임 같은 경우에는 프레임 드롭이 발생하지 않는 게임을 만드는 것이 중요하다. 이럴 경우 프레임 드롭 대책은 필요가 없다.

또한 많은 프레임 중 한 프레임만 드롭된다면 사람들은 그 드롭을 느리다고 느끼지 않기 때문에 신경쓰지 않아도 된다.

혹은 화면이 초기화될 때처럼 여러 프레임이 드롭에 걸릴때는 화면을 검게 하는 등 사람을 속이는 방법도 사용할 수 있다.

##### 각 대책의 장, 단점

| 대책 방법                    | 장점                                       | 단점                                                         |
| ---------------------------- | ------------------------------------------ | ------------------------------------------------------------ |
| 기본 fps를 다시 설정         | 대응 작업이 쉬움                           | 처리 시간이 남아도 낮은 프레임 레이트로 동작하는 상황이 존재<br />개발 도중에 프레임 레이트를 바꾸기 어려움 |
| 프레임 스킵                  | 항상 기본 프레임 레이트로 계산 가능        | 프로그램에서 대응하기가 상당히 어려움                        |
| 앞 프레임과 시간 차이를 계산 | 프레임 스킵보다 프로그램에서 대응하기 쉬움 | 게임 처리 등 악영향(버그)를 일으킬 가능성이 존재             |
| 프레임 드롭을 해결하지 않음  | 대응 작업이 없음                           | 프레임 드롭이 발생                                           |



------
> 본 내용은 도마에 요시키의 "게임을 움직이는 수학과 물리"를 읽으며 공부, 요약한 내용입니다.